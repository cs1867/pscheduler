#!/usr/bin/env python3
#
# Build missing things 
#

import json
import sys

result = json.load(sys.stdin)

#
# Groups
#

if 'groups' not in result:
   result['groups'] = ''

# These are structurally-identical
for group_type in [ 'list', 'mesh' ]:
   result['groups'][group_type] = {
      'type': group_type,
      'addresses': [
         { 'name': key } for key, _value in result['addresses'].items()
      ]
   }



#
# Add all archives to all tasks
#

archive_list = list(result['archives'].keys())

for _key, task in result['tasks'].items():
   task['archives'] = archive_list




print(json.dumps(
    result,
    sort_keys=True,
    indent=4,
    separators=(', ', ': ')
    ))
